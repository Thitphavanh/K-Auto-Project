# ๐ เบเบณเปเบเบฐเบเบณเบเบฒเบเบเบณเปเบเปเปเบเบฅเปเบเบตเปเบเบฑเบเบเบธเบเปเบฅเปเบง

## ๐ เปเบเบฅเปเบเบตเปเบชเปเบฒเบเปเบฅเปเบง:

1. **bill-detail.html** - เปเบเบฅเปเบชเบณเบฅเบฑเบเบชเบฐเปเบเบเปเบเบเบดเบเปเบเปเปเบฒเปเบงเบฑเบ (เบกเบตเบเบธเปเบกเปเบเปเปเบ & เบเบดเบก)
2. **bill-detail-print.html** - เปเบเบฅเปเบชเบณเบฅเบฑเบเบเบดเบกเปเบเบเบดเบ (Auto-print onload)
3. **README.md** - เบเบณเบญเบฐเบเบดเบเบฒเบเบฅเบฒเบเบฅเบฐเบญเบฝเบเบเปเบฝเบงเบเบฑเบเบเบฒเบเบเปเบฝเบเปเบเบ

---

## ๐ฏ เบเบฒเบเบเปเบฝเบเปเบเบเบซเบผเบฑเบ:

### 1. เบชเปเบงเบเบชเบฐเบซเบผเบธเบเบเบฒเบเปเบเบดเบ (เบเบฑเบเปเบซเปเบชเบฐเปเบเบเบเบฑเบ 3 เบชเบฐเบเบธเบเปเบเบดเบเบเปเบญเบกเบเบฑเบ)

#### โ๏ธ เบเปเบญเบเบเบฒเบเบเบฑเบเบเบธเบ:
```
เบฅเบงเบกเบเบญเบเบชเปเบงเบเบซเบผเบธเบ    K xxx,xxx.xx              (เบเบฝเบ LAK เปเบเบปเปเบฒเบเบฑเปเบ)
เบฅเบงเบกเปเบเบดเบ/Total        K xxx,xxx.xx              (เปเบเบเปเบเบง)
                      เธฟ x,xxx.xx
                      $ xxx.xx
เบฅเบงเบกเบชเบธเบเบเบด/Net Amount  K xxx,xxx.xx              (เปเบเบเปเบเบง)
                      เธฟ x,xxx.xx
                      $ xxx.xx
```

#### โ เบซเบผเบฑเบเบเบฒเบเบเบฑเบเบเบธเบ:
```
เบฅเบงเบกเบเบญเบเบชเปเบงเบเบซเบผเบธเบ    K xxx,xxx.xx    เธฟ x,xxx.xx    $ xxx.xx
เบฅเบงเบกเปเบเบดเบ/Total        K xxx,xxx.xx    เธฟ x,xxx.xx    $ xxx.xx
เบฅเบงเบกเบชเบธเบเบเบด/Net Amount  K xxx,xxx.xx    เธฟ x,xxx.xx    $ xxx.xx
```

### 2. เบเบฒเบเบเบฑเบเบงเบฒเบ Layout

- โ เปเบเป `<td>` เปเบเบเบเบฑเบเบชเบณเบฅเบฑเบเปเบเปเบฅเบฐเบชเบฐเบเบธเบเปเบเบดเบ
- โ เบชเบฐเบเบธเบเปเบเบดเบเบเบฑเบ 3 เบขเบนเปเปเบเปเบเบงเบเบฝเบงเบเบฑเบ (เบเปเปเปเบเบเปเบเบง)
- โ เบเบฒเบเบเบฑเบเบงเบฒเบเปเบเบ responsive เปเบฅเบฐเบเปเบฒเบเบเปเปเบเบฒเบเบญเปเบฒเบ

---

## โ เบเบฒเบเบเบงเบเบชเบญเบ Model Fields

เบเปเบญเบเปเบเปเบเบงเบเบชเบญเบเปเบเบฅเป `models.py` เปเบฅเปเบง เปเบฅเบฐเบเปเบฒเบงเบเบตเบเปเปเบเบท:

### ๐ **เบกเบตเบเบตเบงเบเบปเบเบเปเบงเบเปเบฅเปเบงเปเบ Model!**

เปเบกเปเบเบง `Order` เบกเบตเบเบตเบงเบเบตเปเบเบณเปเบเบฑเบเบเบฑเบเปเบปเบ (เบเบดเบเบเบฒเบกเปเบเบฅเป: `store/models.py`, เปเบเบง 236-254):

```python
# โ เบเบญเบเบฅเบงเบก (Subtotal) - เบเบฑเบ 3 เบชเบฐเบเบธเบเปเบเบดเบ
subtotal_lak = models.DecimalField(...)  # เปเบเบง 236
subtotal_thb = models.DecimalField(...)  # เปเบเบง 237
subtotal_usd = models.DecimalField(...)  # เปเบเบง 238

# โ เบชเปเบงเบเบซเบผเบธเบเบฅเบงเบก (Discount) - เบเบฑเบ 3 เบชเบฐเบเบธเบเปเบเบดเบ
discount_lak = models.DecimalField(...)  # เปเบเบง 241
discount_thb = models.DecimalField(...)  # เปเบเบง 242
discount_usd = models.DecimalField(...)  # เปเบเบง 243

# โ เบฅเบงเบกเบชเบธเบเบเบด (Net Amount) - เบเบฑเบ 3 เบชเบฐเบเบธเบเปเบเบดเบ
net_amount_lak = models.DecimalField(...) # เปเบเบง 252
net_amount_thb = models.DecimalField(...) # เปเบเบง 253
net_amount_usd = models.DecimalField(...) # เปเบเบง 254
```

### ๐ก เบเบฒเบเบเบดเบเปเบฅเปเบญเบฑเบเบเบฒเปเบฅเบเบเปเบฝเบ

เบฅเบฐเบเบปเบเบกเบตเบเบฒเบเบเบดเบเปเบฅเปเบญเบฑเบเบเบฒเปเบฅเบเบเปเบฝเบเปเบ method `calculate_totals()` (เปเบเบง 281-320):

```python
def calculate_totals(self):
    # เบเบดเบเปเบฅเปเบเบญเบเบฅเบงเบกเปเบ THB เบเปเบญเบ
    self.subtotal_thb = sum(item.amount for item in items)

    # เปเบเบเปเบเบฑเบเบชเบฐเบเบธเบเปเบเบดเบเบญเบทเปเบเป เปเบเบเปเบเป CurrencyRate model
    from .models import CurrencyRate
    rates = {r.currency_code: r.rate_to_thb for r in CurrencyRate.objects.all()}

    thb_to_lak = rates.get('LAK', Decimal('1'))
    thb_to_usd = rates.get('USD', Decimal('1'))

    # เบเบดเบเปเบฅเปเบชเปเบงเบเบซเบผเบธเบ, เบญเบฒเบเบญเบ, เปเบฅเบฐเบฅเบงเบกเบชเบธเบเบเบดเบชเบณเบฅเบฑเบเบเบฑเบ 3 เบชเบฐเบเบธเบเปเบเบดเบ
    ...
```

---

## ๐ เบงเบดเบเบตเบเบณเปเบเป:

### เบเบฑเปเบเบเบญเบเบเบต 1: เบเบงเบเบชเบญเบเบญเบฑเบเบเบฒเปเบฅเบเบเปเบฝเบ

เปเบซเปเปเบเปเปเบเบงเปเบฒเบกเบตเบเปเปเบกเบนเบเปเบเบเบฒเบเบฐเบฅเบฒเบ `CurrencyRate`:

```python
# เปเบ Django Admin เบซเบผเบท Django Shell
from store.models import CurrencyRate

# เปเบเบตเปเบกเบญเบฑเบเบเบฒเปเบฅเบเบเปเบฝเบ (เบเปเบฒเบเบฑเบเบเปเปเบกเบต)
CurrencyRate.objects.get_or_create(
    currency_code='LAK',
    defaults={
        'name': 'เบเบตเบเบฅเบฒเบง',
        'rate_to_thb': 666.67,  # 1 THB = 666.67 LAK
        'symbol': 'โญ'
    }
)

CurrencyRate.objects.get_or_create(
    currency_code='THB',
    defaults={
        'name': 'เบเบฒเบเปเบ',
        'rate_to_thb': 1.0,  # เบญเปเบฒเบเบญเบตเบ
        'symbol': 'เธฟ'
    }
)

CurrencyRate.objects.get_or_create(
    currency_code='USD',
    defaults={
        'name': 'เปเบเบฅเบฒเบญเบฒเปเบกเบฅเบดเบเบฒ',
        'rate_to_thb': 0.028,  # 1 THB = 0.028 USD
        'symbol': '$'
    }
)
```

### เบเบฑเปเบเบเบญเบเบเบต 2: เปเบเปเบเบฒเบเปเบเปเปเบฅเบตเบ!

เปเบเบฅเปเบเบตเปเบเบฑเบเบเบธเบเปเบฅเปเบงเบเปเบญเบกเปเบเปเบเบฒเบเปเบฅเปเบง:

1. **เปเบเบตเบเปเปเบฒเบเบดเบ** - เปเบเบเบตเป URL เปเบเปเบถเปเบเบเบตเปเบชเบฐเปเบเบเบเบดเบ (เปเบเบฑเปเบ: `/orders/<invoice_no>/`)
2. **เบเบปเบเบเบธเปเบกเบเบดเบกเบเบดเบ** - เบฅเบฐเบเบปเบเบเบฐเปเบเบตเบ `bill-detail-print.html` เปเบฅเบฐเบเบดเบกเบญเบฑเบเบเบฐเปเบเบกเบฑเบ
3. **เบเบปเบเบเบธเปเบกเปเบเปเปเบเบเบดเบ** - เปเบเบซเบฒเปเปเบฒเปเบเปเปเบเบเบดเบ

### เบเบฑเปเบเบเบญเบเบเบต 3: เบเบปเบเบชเบญเบเบเบฒเบเบชเบฐเปเบเบเบเบปเบ

```bash
# เปเบฅเปเบ development server
python manage.py runserver

# เปเบเบปเปเบฒเปเบเปเบเบดเปเบเบเบดเบ
# เบเบงเบเบชเบญเบเบงเปเบฒเบชเบฐเบเบธเบเปเบเบดเบเบเบฑเบ 3 เบชเบฐเปเบเบเบเบปเบเบเบทเบเบฑเบเปเบเปเบเบงเบเบฝเบงเบเบฑเบเบซเบผเบทเบเปเป
```

---

## ๐ เบเบปเบงเบขเปเบฒเบเบเบฒเบเบชเบฐเปเบเบเบเบปเบ:

### เบชเปเบงเบเบชเบฐเบซเบผเบธเบเบเบฒเบเปเบเบดเบ (Summary Section):

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ เบฅเบงเบกเบเบญเบเบชเปเบงเบเบซเบผเบธเบ โ    K 100,000.00  โ  เธฟ 150.00   โ  $ 4.20       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ เบฅเบงเบกเปเบเบดเบ/Total    โ    K 5,000,000   โ  เธฟ 7,500.00 โ  $ 210.00     โ
โ เบญเบฒเบเบญเบ/Tax       โ          0%      โ      -      โ      -        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ เบฅเบงเบกเบชเบธเบเบเบด/Net    โ    K 4,900,000   โ  เธฟ 7,350.00 โ  $ 205.80     โ
โ Net Amount       โ                  โ             โ               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ง เบเบฒเบเปเบเปเปเบเบเบฑเบเบซเบฒ (Troubleshooting):

### เบเบฑเบเบซเบฒ 1: เบชเบฐเบเบธเบเปเบเบดเบเบชเบฐเปเบเบเปเบเบฑเบ "-"

**เบชเบฒเปเบซเบ**: เบเบฑเบเบเปเปเบกเบตเบเบฒเบเบเบดเบเปเบฅเป totals

**เบงเบดเบเบตเปเบเป**:
```python
# เปเบ Django Shell
from store.models import Order

order = Order.objects.get(invoice_no='IVC250108-00001')
order.calculate_totals()  # เบเบดเบเปเบฅเปเปเปเป
```

### เบเบฑเบเบซเบฒ 2: เบญเบฑเบเบเบฒเปเบฅเบเบเปเบฝเบเบเปเปเบเบทเบเบเปเบญเบ

**เบงเบดเบเบตเปเบเป**:
```python
# เบญเบฑเบเปเบเบเบญเบฑเบเบเบฒเปเบฅเบเบเปเบฝเบเปเบ Django Admin
# เบซเบผเบทเปเบเป Shell:
from store.models import CurrencyRate

rate_lak = CurrencyRate.objects.get(currency_code='LAK')
rate_lak.rate_to_thb = 666.67  # เบญเบฑเบเบเบฒเปเปเป
rate_lak.save()

# เบเบฒเบเบเบฑเปเบเบเบดเบเปเบฅเปเบเบดเบเปเปเป
order.calculate_totals()
```

### เบเบฑเบเบซเบฒ 3: Template เบเปเปเบชเบฐเปเบเบเบเบปเบ

**เบงเบดเบเบตเปเบเป**:
- เบเบงเบเบชเบญเบเบงเปเบฒเปเบเบฅเป `bill-detail.html` เปเบฅเบฐ `bill-detail-print.html` เบขเบนเปเปเบเปเบเบเปเบเบตเบเบตเปเบเบทเบเบเปเบญเบ
- Path: `store/templates/orders/`
- Clear cache: `python manage.py collectstatic --clear`

---

## ๐ เบชเบฐเบซเบผเบธเบ:

โ **เปเบเบฅเปเบเบตเปเบชเปเบฒเบเบเบฐเปเบเปเบเบฒเบเปเบเปเปเบฅเบตเบเปเบเบเบเปเปเบกเบต error**
โ **Model เบกเบตเบเบตเบงเบเบปเบเบเปเบงเบเปเบฅเปเบง (subtotal, discount, net_amount เบเบฑเบ 3 เบชเบฐเบเบธเบเปเบเบดเบ)**
โ **เบฅเบฐเบเบปเบเบเบดเบเปเบฅเปเบญเบฑเบเบเบฒเปเบฅเบเบเปเบฝเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบเบเบฒเบเบเบฒเบเบฐเบฅเบฒเบ CurrencyRate**
โ **เบฎเบนเบเปเบเบเบเบฒเบเบชเบฐเปเบเบเบเบปเบเบเบฑเบเบชเบฐเปเป, เบเปเบฒเบเบเปเปเบเบฒเบเบญเปเบฒเบ, เปเบฅเบฐเบเบดเบกเปเบเปเบเบต**
โ **เบฎเบญเบเบฎเบฑเบเบเบฑเบเปเปเบฒเปเบงเบฑเบเปเบฅเบฐเปเปเบฒเบเบดเบกเปเบเบเบเบฑเบ**

---

## ๐ เบเบดเบเบเปเปเบชเบญเบเบเบฒเบก:

เบเปเบฒเบกเบตเบเบณเบเบฒเบกเบซเบผเบทเบเบฑเบเบซเบฒเปเบเป, เบเบฐเบฅเบธเบเบฒเบเบงเบเบชเบญเบ:

1. Model fields เปเบ `store/models.py` (เปเบเบง 190-346)
2. Method `calculate_totals()` (เปเบเบง 281-320)
3. Template files:
   - `store/templates/orders/bill-detail.html`
   - `store/templates/orders/bill-detail-print.html`

**เบเปเปเบซเปเบเบธเบเบเบฒเบเบเบณเปเบเบตเบเบเบธเบฅเบฐเบเบดเบเบชเบฐเบเบงเบ เปเบฅเบฐเบฅเบฐเบเบปเบเปเบเปเบเบฒเบเปเบเปเบเบต!** ๐
